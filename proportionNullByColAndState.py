"""
Hrishee S.
A python script to count the ratio of null/non-null grouped by column and by state in the L2 voter file
"""

from pprint import pprint
# import duckdb
# import pandas as pd

COLS = ['SEQUENCE',
 'LALVOTERID',
 'Voters_Active',
 'Voters_StateVoterID',
 'Voters_CountyVoterID',
 'VoterTelephones_LandlineAreaCode',
 'VoterTelephones_Landline7Digit',
 'VoterTelephones_LandlineFormatted',
 'VoterTelephones_LandlineUnformatted',
 'VoterTelephones_LandlineConfidenceCode',
 'VoterTelephones_CellPhoneOnly',
 'VoterTelephones_CellPhoneFormatted',
 'VoterTelephones_CellPhoneUnformatted',
 'VoterTelephones_CellConfidenceCode',
 'Voters_FirstName',
 'Voters_MiddleName',
 'Voters_LastName',
 'Voters_NameSuffix',
 'Residence_Addresses_AddressLine',
 'Residence_Addresses_ExtraAddressLine',
 'Residence_Addresses_City',
 'Residence_Addresses_State',
 'Residence_Addresses_Zip',
 'Residence_Addresses_ZipPlus4',
 'Residence_Addresses_DPBC',
 'Residence_Addresses_CheckDigit',
 'Residence_Addresses_HouseNumber',
 'Residence_Addresses_PrefixDirection',
 'Residence_Addresses_StreetName',
 'Residence_Addresses_Designator',
 'Residence_Addresses_SuffixDirection',
 'Residence_Addresses_ApartmentNum',
 'Residence_Addresses_ApartmentType',
 'Residence_Addresses_CassErrStatCode',
 'Voters_SequenceZigZag',
 'Voters_SequenceOddEven',
 'Residence_Addresses_CensusTract',
 'Residence_Addresses_CensusBlockGroup',
 'Residence_Addresses_CensusBlock',
 'Residence_Addresses_Latitude',
 'Residence_Addresses_Longitude',
 'Residence_Addresses_LatLongAccuracy',
 'Residence_Addresses_Property_LandSq_Footage',
 'Residence_Addresses_Property_HomeSq_Footage',
 'Residence_Addresses_Density',
 'Residence_Families_FamilyID',
 'Residence_Families_HHCount',
 'Residence_HHGender_Description',
 'Residence_HHParties_Description',
 'Mailing_Addresses_AddressLine',
 'Mailing_Addresses_ExtraAddressLine',
 'Mailing_Addresses_City',
 'Mailing_Addresses_State',
 'Mailing_Addresses_Zip',
 'Mailing_Addresses_ZipPlus4',
 'Mailing_Addresses_DPBC',
 'Mailing_Addresses_CheckDigit',
 'Mailing_Addresses_HouseNumber',
 'Mailing_Addresses_PrefixDirection',
 'Mailing_Addresses_StreetName',
 'Mailing_Addresses_Designator',
 'Mailing_Addresses_SuffixDirection',
 'Mailing_Addresses_ApartmentNum',
 'Mailing_Addresses_ApartmentType',
 'Mailing_Addresses_CassErrStatCode',
 'Mailing_Families_FamilyID',
 'Mailing_Families_HHCount',
 'Mailing_HHGender_Description',
 'Mailing_HHParties_Description',
 'Voters_Gender',
 'Voters_Age',
 'Voters_BirthDate',
 'DateConfidence_Description',
 'Parties_Description',
 'VoterParties_Change_Changed_Party',
 'Ethnic_Description',
 'EthnicGroups_EthnicGroup1Desc',
 'CountyEthnic_LALEthnicCode',
 'CountyEthnic_Description',
 'Religions_Description',
 'Voters_CalculatedRegDate',
 'Voters_OfficialRegDate',
 'Voters_PlaceOfBirth',
 'Languages_Description',
 'AbsenteeTypes_Description',
 'MilitaryStatus_Description',
 'MaritalStatus_Description',
 'Voters_MovedFrom_State',
 'Voters_MovedFrom_Date',
 'Voters_MovedFrom_Party_Description',
 'Voters_MovedFrom_VotingPerformanceEvenYearGeneral',
 'Voters_MovedFrom_VotingPerformanceEvenYearPrimary',
 'Voters_MovedFrom_VotingPerformanceEvenYearGeneralAndPrimary',
 'Voters_MovedFrom_VotingPerformanceMinorElection',
 'US_Congressional_District',
 'AddressDistricts_Change_Changed_CD',
 'State_Senate_District',
 'AddressDistricts_Change_Changed_SD',
 'State_House_District',
 'AddressDistricts_Change_Changed_HD',
 'State_Legislative_District',
 'AddressDistricts_Change_Changed_LD',
 'County',
 'Voters_FIPS',
 'AddressDistricts_Change_Changed_County',
 'Precinct',
 'County_Commissioner_District',
 'County_Supervisorial_District',
 'County_Legislative_District',
 'City',
 'City_Council_Commissioner_District',
 'City_Ward',
 'City_Mayoral_District',
 'Town_District',
 'Town_Ward',
 'Town_Council',
 'Village',
 'Village_Ward',
 'Township',
 'Township_Ward',
 'Borough',
 'Borough_Ward',
 'Hamlet_Community_Area',
 '2010_US_Congressional_District',
 '2010_State_Senate_District',
 '2010_State_House_District',
 '2010_State_Legislative_District',
 '2001_US_Congressional_District',
 '2001_State_Senate_District',
 '2001_State_House_District',
 '2001_State_Legislative_District',
 '4H_Livestock_District',
 'Airport_District',
 'Annexation_District',
 'Aquatic_Center_District',
 'Aquatic_District',
 'Assessment_District',
 'Bay_Area_Rapid_Transit',
 'Board_of_Education_District',
 'Board_of_Education_SubDistrict',
 'Bonds_District',
 'Career_Center',
 'Cemetery_District',
 'Central_Committee_District',
 'Chemical_Control_District',
 'City_School_District',
 'Coast_Water_District',
 'College_Board_District',
 'Committee_Super_District',
 'Communications_District',
 'Community_College',
 'Community_College_Commissioner_District',
 'Community_College_SubDistrict',
 'Community_College_At_Large',
 'Community_Council_District',
 'Community_Council_SubDistrict',
 'Community_Facilities_District',
 'Community_Facilities_SubDistrict',
 'Community_Hospital_District',
 'Community_Planning_Area',
 'Community_Service_District',
 'Community_Service_SubDistrict',
 'Congressional_Township',
 'Conservation_District',
 'Conservation_SubDistrict',
 'Consolidated_Water_District',
 'Control_Zone_District',
 'Corrections_District',
 'County_Board_of_Education_District',
 'County_Board_of_Education_SubDistrict',
 'County_Community_College_District',
 'County_Fire_District',
 'County_Hospital_District',
 'County_Library_District',
 'County_Memorial_District',
 'County_Paramedic_District',
 'County_Service_Area',
 'County_Service_Area_SubDistrict',
 'County_Sewer_District',
 'County_Superintendent_of_Schools_District',
 'County_Unified_School_District',
 'County_Water_District',
 'County_Water_Landowner_District',
 'County_Water_SubDistrict',
 'Democratic_Convention_Member',
 'Democratic_Zone',
 'Designated_Market_Area_DMA',
 'District_Attorney',
 'Drainage_District',
 'Education_Commission_District',
 'Educational_Service_District',
 'Educational_Service_Subdistrict',
 'Election_Commissioner_District',
 'Elementary_School_District',
 'Elementary_School_SubDistrict',
 'Emergency_Communication_911_District',
 'Emergency_Communication_911_SubDistrict',
 'Enterprise_Zone_District',
 'Exempted_Village_School_District',
 'EXT_District',
 'Facilities_Improvement_District',
 'Fire_District',
 'Fire_Maintenance_District',
 'Fire_Protection_District',
 'Fire_Protection_SubDistrict',
 'Fire_Protection_Tax_Measure_District',
 'Fire_Service_Area_District',
 'Fire_SubDistrict',
 'Flood_Control_Zone',
 'Forest_Preserve',
 'Garbage_District',
 'Geological_Hazard_Abatement_District',
 'Health_District',
 'High_School_District',
 'High_School_SubDistrict',
 'Hospital_District',
 'Hospital_SubDistrict',
 'Improvement_Landowner_District',
 'Independent_Fire_District',
 'Irrigation_District',
 'Irrigation_SubDistrict',
 'Island',
 'Judicial_Appellate_District',
 'Judicial_Chancery_Court',
 'Judicial_Circuit_Court_District',
 'Judicial_County_Board_of_Review_District',
 'Judicial_County_Court_District',
 'Judicial_District',
 'Judicial_District_Court_District',
 'Judicial_Family_Court_District',
 'Judicial_Jury_District',
 'Judicial_Juvenile_Court_District',
 'Judicial_Magistrate_Division',
 'Judicial_Sub_Circuit_District',
 'Judicial_Superior_Court_District',
 'Judicial_Supreme_Court_District',
 'Justice_of_the_Peace',
 'Land_Commission',
 'Landscaping_And_Lighting_Assessment_Distric',
 'Law_Enforcement_District',
 'Learning_Community_Coordinating_Council_District',
 'Levee_District',
 'Levee_Reconstruction_Assesment_District',
 'Library_District',
 'Library_Services_District',
 'Library_SubDistrict',
 'Lighting_District',
 'Local_Hospital_District',
 'Local_Park_District',
 'Maintenance_District',
 'Master_Plan_District',
 'Memorial_District',
 'Metro_Service_District',
 'Metro_Service_Subdistrict',
 'Metro_Transit_District',
 'Metropolitan_Water_District',
 'Middle_School_District',
 'Mosquito_Abatement_District',
 'Mountain_Water_District',
 'Multi_township_Assessor',
 'Municipal_Advisory_Council_District',
 'Municipal_Court_District',
 'Municipal_Utility_District',
 'Municipal_Utility_SubDistrict',
 'Municipal_Water_District',
 'Municipal_Water_SubDistrict',
 'Museum_District',
 'Northeast_Soil_and_Water_District',
 'Open_Space_District',
 'Open_Space_SubDistrict',
 'Other',
 'Paramedic_District',
 'Park_Commissioner_District',
 'Park_District',
 'Park_SubDistrict',
 'Planning_Area_District',
 'Police_District',
 'Port_District',
 'Port_SubDistrict',
 'Power_District',
 'Proposed_City',
 'Proposed_City_Commissioner_District',
 'Proposed_Community_College',
 'Proposed_District',
 'Proposed_Elementary_School_District',
 'Proposed_Fire_District',
 'Proposed_Unified_School_District',
 'Public_Airport_District',
 'Public_Regulation_Commission',
 'Public_Service_Commission_District',
 'Public_Utility_District',
 'Public_Utility_SubDistrict',
 'Rapid_Transit_District',
 'Rapid_Transit_SubDistrict',
 'Reclamation_District',
 'Recreation_District',
 'Recreational_SubDistrict',
 'Regional_Office_of_Education_District',
 'Republican_Area',
 'Republican_Convention_Member',
 'Resort_Improvement_District',
 'Resource_Conservation_District',
 'River_Water_District',
 'Road_Maintenance_District',
 'Rural_Service_District',
 'Sanitary_District',
 'Sanitary_SubDistrict',
 'School_Board_District',
 'School_District',
 'School_District_Vocational',
 'School_Facilities_Improvement_District',
 'School_Subdistrict',
 'Service_Area_District',
 'Sewer_District',
 'Sewer_Maintenance_District',
 'Sewer_SubDistrict',
 'Snow_Removal_District',
 'Soil_And_Water_District',
 'Soil_And_Water_District_At_Large',
 'Special_Reporting_District',
 'Special_Tax_District',
 'State_Board_of_Equalization',
 'Storm_Water_District',
 'Street_Lighting_District',
 'Superintendent_of_Schools_District',
 'Transit_District',
 'Transit_SubDistrict',
 'TriCity_Service_District',
 'TV_Translator_District',
 'Unified_School_District',
 'Unified_School_SubDistrict',
 'Unincorporated_District',
 'Unincorporated_Park_District',
 'Unprotected_Fire_District',
 'Ute_Creek_Soil_District',
 'Vector_Control_District',
 'Vote_By_Mail_Area',
 'Wastewater_District',
 'Water_Agency',
 'Water_Agency_SubDistrict',
 'Water_Conservation_District',
 'Water_Conservation_SubDistrict',
 'Water_Control__Water_Conservation',
 'Water_Control__Water_Conservation_SubDistrict',
 'Water_District',
 'Water_Public_Utility_District',
 'Water_Public_Utility_Subdistrict',
 'Water_Replacement_District',
 'Water_Replacement_SubDistrict',
 'Water_SubDistrict',
 'Weed_District',
 'CommercialData_BookBuyerInHome',
 'CommercialData_ComputerOwnerInHome',
 'CommercialData_CulinaryInterestMagazineInHome',
 'CommercialData_DoItYourselferMagazineInHome',
 'CommercialData_DonatesEnvironmentCauseInHome',
 'CommercialData_DonatesToCharityInHome',
 'CommercialData_DwellingType',
 'CommercialData_DwellingUnitSize',
 'CommercialData_Education',
 'CommercialData_EstHomeValue',
 'CommercialData_EstimatedHHIncome',
 'CommercialData_EstimatedHHIncomeAmount',
 'CommercialData_EstimatedAreaMedianHHIncome',
 'CommercialData_FamilyMagazineInHome',
 'CommercialData_FemaleOrientedMagazineInHome',
 'CommercialData_FinancialMagazineInHome',
 'CommercialData_GardeningMagazineInHome',
 'CommercialData_HealthFitnessMagazineInHome',
 'CommercialData_HHComposition',
 'CommercialData_HomePurchaseDate',
 'CommercialData_HomePurchasePrice',
 'CommercialData_ISPSA',
 'CommercialData_LandValue',
 'CommercialData_LikelyUnion',
 'CommercialData_AreaMedianEducationYears',
 'CommercialData_AreaMedianHousingValue',
 'CommercialData_MosaicZ4',
 'CommercialData_MosaicZ4Global',
 'CommercialData_Occupation',
 'CommercialData_OccupationGroup',
 'CommercialData_OccupationIndustry',
 'CommercialData_AreaPcntHHMarriedCoupleNoChild',
 'CommercialData_AreaPcntHHMarriedCoupleWithChild',
 'CommercialData_AreaPcntHHSpanishSpeaking',
 'CommercialData_AreaPcntHHWithChildren',
 'CommercialData_PoliticalContributerInHome',
 'CommercialData_PresenceOfChildrenCode',
 'CommercialData_PresenceOfPremCredCrdInHome',
 'CommercialData_PropertyType',
 'CommercialData_ReligiousContributorInHome',
 'CommercialData_ReligiousMagazineInHome',
 'CommercialData_StateIncomeDecile',
 'CommercialData_UpscaleBuyerInHome',
 'CommercialData_UpscaleFemaleBuyerInHome',
 'CommercialData_UpscaleMaleBuyerInHome',
 'ElectionReturns_G08_Cnty_Margin_McCain_R',
 'ElectionReturns_G08_Cnty_Percent_McCain_R',
 'ElectionReturns_G08_Cnty_Vote_McCain_R',
 'ElectionReturns_G08_Cnty_Margin_Obama_D',
 'ElectionReturns_G08_Cnty_Percent_Obama_D',
 'ElectionReturns_G08_Cnty_Vote_Obama_D',
 'ElectionReturns_G08CountyTurnoutAllRegisteredVoters',
 'ElectionReturns_G08CountyTurnoutDemocrats',
 'ElectionReturns_G08CountyTurnoutIndependentsAllOthers',
 'ElectionReturns_G08CountyTurnoutRepublicans',
 'ElectionReturns_G08PrecinctTurnoutAllRegisteredVoters',
 'ElectionReturns_G08PrecinctTurnoutDemocrats',
 'ElectionReturns_G08PrecinctTurnoutIndependentsAllOthers',
 'ElectionReturns_G08PrecinctTurnoutRepublicans',
 'ElectionReturns_G10CountyTurnoutAllRegisteredVoters',
 'ElectionReturns_G10CountyTurnoutDemocrats',
 'ElectionReturns_G10CountyTurnoutIndependentsAllOthers',
 'ElectionReturns_G10CountyTurnoutRepublicans',
 'ElectionReturns_G10PrecinctTurnoutAllRegisteredVoters',
 'ElectionReturns_G10PrecinctTurnoutDemocrats',
 'ElectionReturns_G10PrecinctTurnoutIndependentsAllOthers',
 'ElectionReturns_G10PrecinctTurnoutRepublicans',
 'ElectionReturns_G12_Cnty_Margin_Obama_D',
 'ElectionReturns_G12_Cnty_Percent_Obama_D',
 'ElectionReturns_G12_Cnty_Vote_Obama_D',
 'ElectionReturns_G12_Cnty_Margin_Romney_R',
 'ElectionReturns_G12_Cnty_Percent_Romney_R',
 'ElectionReturns_G12_Cnty_Vote_Romney_R',
 'ElectionReturns_G12CountyTurnoutAllRegisteredVoters',
 'ElectionReturns_G12CountyTurnoutDemocrats',
 'ElectionReturns_G12CountyTurnoutIndependentsAllOthers',
 'ElectionReturns_G12CountyTurnoutRepublicans',
 'ElectionReturns_G12PrecinctTurnoutAllRegisteredVoters',
 'ElectionReturns_G12PrecinctTurnoutDemocrats',
 'ElectionReturns_G12PrecinctTurnoutIndependentsAllOthers',
 'ElectionReturns_G12PrecinctTurnoutRepublicans',
 'ElectionReturns_G14CountyTurnoutAllRegisteredVoters',
 'ElectionReturns_G14CountyTurnoutDemocrats',
 'ElectionReturns_G14CountyTurnoutIndependentsAllOthers',
 'ElectionReturns_G14CountyTurnoutRepublicans',
 'ElectionReturns_G14PrecinctTurnoutAllRegisteredVoters',
 'ElectionReturns_G14PrecinctTurnoutDemocrats',
 'ElectionReturns_G14PrecinctTurnoutIndependentsAllOthers',
 'ElectionReturns_G14PrecinctTurnoutRepublicans',
 'ElectionReturns_G16_Cnty_Margin_Clinton_D',
 'ElectionReturns_G16_Cnty_Percent_Clinton_D',
 'ElectionReturns_G16_Cnty_Vote_Clinton_D',
 'ElectionReturns_G16_Cnty_Margin_Trump_R',
 'ElectionReturns_G16_Cnty_Percent_Trump_R',
 'ElectionReturns_G16_Cnty_Vote_Trump_R',
 'ElectionReturns_G16CountyTurnoutAllRegisteredVoters',
 'ElectionReturns_G16CountyTurnoutDemocrats',
 'ElectionReturns_G16CountyTurnoutIndependentsAllOthers',
 'ElectionReturns_G16CountyTurnoutRepublicans',
 'ElectionReturns_G16PrecinctTurnoutAllRegisteredVoters',
 'ElectionReturns_G16PrecinctTurnoutDemocrats',
 'ElectionReturns_G16PrecinctTurnoutIndependentsAllOthers',
 'ElectionReturns_G16PrecinctTurnoutRepublicans',
 'ElectionReturns_G18CountyTurnoutAllRegisteredVoters',
 'ElectionReturns_G18CountyTurnoutDemocrats',
 'ElectionReturns_G18CountyTurnoutIndependentsAllOthers',
 'ElectionReturns_G18CountyTurnoutRepublicans',
 'ElectionReturns_G18PrecinctTurnoutAllRegisteredVoters',
 'ElectionReturns_G18PrecinctTurnoutDemocrats',
 'ElectionReturns_G18PrecinctTurnoutIndependentsAllOthers',
 'ElectionReturns_G18PrecinctTurnoutRepublicans',
 'ElectionReturns_G20_Cnty_Margin_Biden_D',
 'ElectionReturns_G20_Cnty_Percent_Biden_D',
 'ElectionReturns_G20_Cnty_Vote_Biden_D',
 'ElectionReturns_G20_Cnty_Margin_Trump_R',
 'ElectionReturns_G20_Cnty_Percent_Trump_R',
 'ElectionReturns_G20_Cnty_Vote_Trump_R',
 'ElectionReturns_G20CountyTurnoutAllRegisteredVoters',
 'ElectionReturns_G20CountyTurnoutDemocrats',
 'ElectionReturns_G20CountyTurnoutIndependentsAllOthers',
 'ElectionReturns_G20CountyTurnoutRepublicans',
 'ElectionReturns_G20PrecinctTurnoutAllRegisteredVoters',
 'ElectionReturns_G20PrecinctTurnoutDemocrats',
 'ElectionReturns_G20PrecinctTurnoutIndependentsAllOthers',
 'ElectionReturns_G20PrecinctTurnoutRepublicans',
 'ElectionReturns_P08_Cnty_Pct_Biden_D',
 'ElectionReturns_P08_Cnty_Pct_Clinton_D',
 'ElectionReturns_P08_Cnty_Pct_Dodd_D',
 'ElectionReturns_P08_Cnty_Pct_Edwards_D',
 'ElectionReturns_P08_Cnty_Pct_Gravel_D',
 'ElectionReturns_P08_Cnty_Pct_Kucinich_D',
 'ElectionReturns_P08_Cnty_Pct_Obama_D',
 'ElectionReturns_P08_Cnty_Pct_Richardson_D',
 'ElectionReturns_P08_Cnty_Vote_Biden_D',
 'ElectionReturns_P08_Cnty_Vote_Clinton_D',
 'ElectionReturns_P08_Cnty_Vote_Dodd_D',
 'ElectionReturns_P08_Cnty_Vote_Edwards_D',
 'ElectionReturns_P08_Cnty_Vote_Gravel_D',
 'ElectionReturns_P08_Cnty_Vote_Kucinich_D',
 'ElectionReturns_P08_Cnty_Vote_Obama_D',
 'ElectionReturns_P08_Cnty_Vote_Richardson_D',
 'ElectionReturns_P08_Cnty_Pct_Giuliani_R',
 'ElectionReturns_P08_Cnty_Pct_Huckabee_R',
 'ElectionReturns_P08_Cnty_Pct_Hunter_R',
 'ElectionReturns_P08_Cnty_Pct_Keyes_R',
 'ElectionReturns_P08_Cnty_Pct_McCain_R',
 'ElectionReturns_P08_Cnty_Pct_Paul_R',
 'ElectionReturns_P08_Cnty_Pct_Romney_R',
 'ElectionReturns_P08_Cnty_Pct_Thompson_R',
 'ElectionReturns_P08_Cnty_Vote_Giuliani_R',
 'ElectionReturns_P08_Cnty_Vote_Huckabee_R',
 'ElectionReturns_P08_Cnty_Vote_Hunter_R',
 'ElectionReturns_P08_Cnty_Vote_Keyes_R',
 'ElectionReturns_P08_Cnty_Vote_McCain_R',
 'ElectionReturns_P08_Cnty_Vote_Paul_R',
 'ElectionReturns_P08_Cnty_Vote_Romney_R',
 'ElectionReturns_P08_Cnty_Vote_Thompson_R',
 'ElectionReturns_P08CountyTurnoutAllRegisteredVoters',
 'ElectionReturns_P08CountyTurnoutDemocrats',
 'ElectionReturns_P08CountyTurnoutRepublicans',
 'ElectionReturns_P08PrecinctTurnoutAllRegisteredVoters',
 'ElectionReturns_P08PrecinctTurnoutDemocrats',
 'ElectionReturns_P08PrecinctTurnoutRepublicans',
 'ElectionReturns_P10CountyTurnoutAllRegisteredVoters',
 'ElectionReturns_P10CountyTurnoutDemocrats',
 'ElectionReturns_P10CountyTurnoutRepublicans',
 'ElectionReturns_P10PrecinctTurnoutAllRegisteredVoters',
 'ElectionReturns_P10PrecinctTurnoutDemocrats',
 'ElectionReturns_P10PrecinctTurnoutRepublicans',
 'ElectionReturns_P12_Cnty_Pct_Bachman_R',
 'ElectionReturns_P12_Cnty_Pct_Gingrich_R',
 'ElectionReturns_P12_Cnty_Pct_Huntsman_R',
 'ElectionReturns_P12_Cnty_Pct_Paul_R',
 'ElectionReturns_P12_Cnty_Pct_Perry_R',
 'ElectionReturns_P12_Cnty_Pct_Romney_R',
 'ElectionReturns_P12_Cnty_Pct_Santorum_R',
 'ElectionReturns_P12_Cnty_Vote_Bachman_R',
 'ElectionReturns_P12_Cnty_Vote_Gingrich_R',
 'ElectionReturns_P12_Cnty_Vote_Huntsman_R',
 'ElectionReturns_P12_Cnty_Vote_Paul_R',
 'ElectionReturns_P12_Cnty_Vote_Perry_R',
 'ElectionReturns_P12_Cnty_Vote_Romney_R',
 'ElectionReturns_P12_Cnty_Vote_Santorum_R',
 'ElectionReturns_P12CountyTurnoutAllRegisteredVoters',
 'ElectionReturns_P12CountyTurnoutDemocrats',
 'ElectionReturns_P12CountyTurnoutRepublicans',
 'ElectionReturns_P12PrecinctTurnoutAllRegisteredVoters',
 'ElectionReturns_P12PrecinctTurnoutDemocrats',
 'ElectionReturns_P12PrecinctTurnoutRepublicans',
 'ElectionReturns_P14CountyTurnoutAllRegisteredVoters',
 'ElectionReturns_P14CountyTurnoutDemocrats',
 'ElectionReturns_P14CountyTurnoutRepublicans',
 'ElectionReturns_P14PrecinctTurnoutAllRegisteredVoters',
 'ElectionReturns_P14PrecinctTurnoutDemocrats',
 'ElectionReturns_P14PrecinctTurnoutRepublicans',
 'ElectionReturns_P16_Cnty_Pct_Bush_R',
 'ElectionReturns_P16_Cnty_Pct_Carson_R',
 'ElectionReturns_P16_Cnty_Pct_Christie_R',
 'ElectionReturns_P16_Cnty_Pct_Cruz_R',
 'ElectionReturns_P16_Cnty_Pct_Fiorina_R',
 'ElectionReturns_P16_Cnty_Pct_Kasich_R',
 'ElectionReturns_P16_Cnty_Pct_Rubio_R',
 'ElectionReturns_P16_Cnty_Pct_Trump_R',
 'ElectionReturns_P16_Cnty_Vote_Bush_R',
 'ElectionReturns_P16_Cnty_Vote_Carson_R',
 'ElectionReturns_P16_Cnty_Vote_Christie_R',
 'ElectionReturns_P16_Cnty_Vote_Cruz_R',
 'ElectionReturns_P16_Cnty_Vote_Fiorina_R',
 'ElectionReturns_P16_Cnty_Vote_Kasich_R',
 'ElectionReturns_P16_Cnty_Vote_Rubio_R',
 'ElectionReturns_P16_Cnty_Vote_Trump_R',
 'ElectionReturns_P16_Cnty_Pct_Clinton_D',
 'ElectionReturns_P16_Cnty_Pct_Sanders_D',
 'ElectionReturns_P16_Cnty_Vote_Clinton_D',
 'ElectionReturns_P16_Cnty_Vote_Sanders_D',
 'ElectionReturns_P16CountyTurnoutAllRegisteredVoters',
 'ElectionReturns_P16CountyTurnoutDemocrats',
 'ElectionReturns_P16CountyTurnoutRepublicans',
 'ElectionReturns_P16PrecinctTurnoutAllRegisteredVoters',
 'ElectionReturns_P16PrecinctTurnoutDemocrats',
 'ElectionReturns_P16PrecinctTurnoutRepublicans',
 'ElectionReturns_P18CountyTurnoutAllRegisteredVoters',
 'ElectionReturns_P18CountyTurnoutDemocrats',
 'ElectionReturns_P18CountyTurnoutRepublicans',
 'ElectionReturns_P18PrecinctTurnoutAllRegisteredVoters',
 'ElectionReturns_P18PrecinctTurnoutDemocrats',
 'ElectionReturns_P18PrecinctTurnoutRepublicans',
 'ElectionReturns_P20_Cnty_Pct_Biden_D',
 'ElectionReturns_P20_Cnty_Pct_Bloomberg_D',
 'ElectionReturns_P20_Cnty_Pct_Buttigieg_D',
 'ElectionReturns_P20_Cnty_Pct_Gabbard_D',
 'ElectionReturns_P20_Cnty_Pct_Klobuchar_D',
 'ElectionReturns_P20_Cnty_Pct_Sanders_D',
 'ElectionReturns_P20_Cnty_Pct_Warren_D',
 'ElectionReturns_P20_Cnty_Vote_Biden_D',
 'ElectionReturns_P20_Cnty_Vote_Bloomberg_D',
 'ElectionReturns_P20_Cnty_Vote_Buttigieg_D',
 'ElectionReturns_P20_Cnty_Vote_Gabbard_D',
 'ElectionReturns_P20_Cnty_Vote_Klobuchar_D',
 'ElectionReturns_P20_Cnty_Vote_Sanders_D',
 'ElectionReturns_P20_Cnty_Vote_Warren_D',
 'ElectionReturns_P20CountyTurnoutAllRegisteredVoters',
 'ElectionReturns_P20CountyTurnoutDemocrats',
 'ElectionReturns_P20CountyTurnoutRepublicans',
 'ElectionReturns_P20PrecinctTurnoutAllRegisteredVoters',
 'ElectionReturns_P20PrecinctTurnoutDemocrats',
 'ElectionReturns_P20PrecinctTurnoutRepublicans',
 'FECDonors_AvgDonation',
 'FECDonors_AvgDonation_Range',
 'FECDonors_LastDonationDate',
 'FECDonors_NumberOfDonations',
 'FECDonors_PrimaryRecipientOfContributions',
 'FECDonors_TotalDonationsAmount',
 'FECDonors_TotalDonationsAmt_Range',
 'Voters_VotingPerformanceEvenYearGeneral',
 'Voters_VotingPerformanceEvenYearPrimary',
 'Voters_VotingPerformanceEvenYearGeneralAndPrimary',
 'Voters_VotingPerformanceMinorElection',
 'General_2022',
 'Primary_2022',
 'OtherElection_2022',
 'AnyElection_2021',
 'General_2020',
 'Primary_2020',
 'PresidentialPrimary_2020',
 'OtherElection_2020',
 'AnyElection_2019',
 'General_2018',
 'Primary_2018',
 'OtherElection_2018',
 'AnyElection_2017',
 'General_2016',
 'Primary_2016',
 'PresidentialPrimary_2016',
 'OtherElection_2016',
 'AnyElection_2015',
 'General_2014',
 'Primary_2014',
 'OtherElection_2014',
 'AnyElection_2013',
 'General_2012',
 'Primary_2012',
 'PresidentialPrimary_2012',
 'OtherElection_2012',
 'AnyElection_2011',
 'General_2010',
 'Primary_2010',
 'OtherElection_2010',
 'AnyElection_2009',
 'General_2008',
 'Primary_2008',
 'PresidentialPrimary_2008',
 'OtherElection_2008',
 'AnyElection_2007',
 'General_2006',
 'Primary_2006',
 'OtherElection_2006',
 'AnyElection_2005',
 'General_2004',
 'Primary_2004',
 'PresidentialPrimary_2004',
 'OtherElection_2004',
 'AnyElection_2003',
 'General_2002',
 'Primary_2002',
 'OtherElection_2002',
 'AnyElection_2001',
 'General_2000',
 'Primary_2000',
 'PresidentialPrimary_2000',
 'OtherElection_2000',
 'PRI_BLT_2022',
 'PRI_BLT_2021',
 'PRI_BLT_2020',
 'PRI_BLT_2019',
 'PRI_BLT_2018',
 'PRI_BLT_2017',
 'PRI_BLT_2016',
 'PRI_BLT_2015',
 'PRI_BLT_2014',
 'PRI_BLT_2013',
 'PRI_BLT_2012',
 'PRI_BLT_2011',
 'PRI_BLT_2010',
 'PRI_BLT_2009',
 'PRI_BLT_2008',
 'PRI_BLT_2007',
 'PRI_BLT_2006',
 'PRI_BLT_2005',
 'PRI_BLT_2004',
 'PRI_BLT_2003',
 'PRI_BLT_2002',
 'PRI_BLT_2001',
 'PRI_BLT_2000']

# COLS = [
#  'Residence_Addresses_Property_HomeSq_Footage',
#  'Residence_Addresses_Density',
#  'Residence_HHGender_Description'
# ]

def build_sql(STATE_COL, DB_NAME, TABLE_NAME):
    sql_builder = ""

    for i in range(len(COLS)):
        col = COLS[i]
        union = '' if i == len(COLS) - 1 else 'UNION'
        sql_for_single_col = f'''(SELECT {STATE_COL} AS state,
            '{col}' AS column_name,
            COUNT(*) AS sample_size,
            (COUNT(*) FILTER (WHERE "{col}" IS NOT NULL)) AS non_null_total,
            (COUNT(*) FILTER (WHERE "{col}" IS NULL)) AS null_total,
            (non_null_total * 100.0 / sample_size) AS non_null_percentage,
            (null_total * 100.0 / sample_size) AS null_percentage
        FROM 
            {TABLE_NAME}
        GROUP BY state)'''

        sql_builder = sql_builder + f'''
            {sql_for_single_col}
        {union}'''

    sql_builder = '''
    SELECT * 
    FROM 
    ''' + sql_builder

    return sql_builder

def csv_export_sql_query(sql_string, output_csv):
    return f"COPY ({sql_string}) TO '{output_csv}' (HEADER, DELIMITER ',')"

if __name__ == "__main__":
    STATE_COL = 'SUBSTRING(LALVOTERID, 4, 2)'
    DB_NAME = 'voter_database_full.duckdb'
    TABLE_NAME = 'VOTER_DATA'
    sql = build_sql(STATE_COL=STATE_COL, DB_NAME=DB_NAME, TABLE_NAME=TABLE_NAME)
    print(sql)
    sql_export_query = csv_export_sql_query(sql, "output.csv")
    

